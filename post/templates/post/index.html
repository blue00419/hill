
{% extends 'base.html' %}

{% block contents %}
    
    <main style="display:flex;">
        <section style="margin-left:100px;">
            <article> 
                <div style="height:130px;">
                    <tr>
                        <div class="box" style="background: #BDBDBD;">
                            <img class="profile" src="/static/img/aaa.jpg">
                        </div>
                    </tr>
                </div>
                <div style="height:70px; max-height:70px;">
                    <table style="width:100%;">
                        <tbody>
                            {% if request.session.login_session %}
                            <td style="text-align:center; height:100%;">
                                <p>{{ nickname }}</p>
                            </td>
                            <td style="text-align:center; height:100%;">
                                <input type="button" onclick="location.href='/post/logout/'" value="로그아웃"></input>
                            </td>
                            {% else %}
                            <td style="text-align:center; height:100%;">
                                <input type="button" onclick="location.href='/post/login/'" value="로그인"></input>
                            </td>
                            <td style="text-align:center; height:100%;">
                                <input type="button" onclick="location.href='/post/signup/'" value="회원가입"></input>
                            </td>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </article>
                
            <article>
                <table style="width:100%; text-align:center; height:100%;">
                    <tbody>
                        <dib>
                            <tr>
                                <form action="{% url 'post:index' %}" method="post">
                                    {% csrf_token %}
                                    <td style="text-align:center;">
                                        <input type="submit" name="post0" id="post0" 
                                        class="post_btn" value="전체 게시판"></input></td>
                                </form>
                            </tr>
                            <tr>
                                <form action="{% url 'post:index' %}" method="post">
                                    {% csrf_token %}
                                    <td>
                                        <input type="submit" name="post1" id="post1" 
                                        class="post_btn" value="잡담 게시판"></input></td>
                                </form>
                            </tr>
                            <tr>
                                <form action="{% url 'post:index' %}" method="post">
                                    {% csrf_token %}
                                    <td>
                                        <input type="submit" name="post2" id="post2" 
                                        class="post_btn" value="공부 게시판"></input></td>
                                </form>
                            </tr>
                            <tr>
                                <form action="{% url 'post:index' %}" method="post">
                                    {% csrf_token %}
                                    <td>
                                        <input type="submit" name="post3" id="post3" 
                                        class="post_btn" value="운동 게시판"></input></td>
                                </form>
                            </tr>
                        </div>
                    </tbody>
                </table>
            </article>
        </section>


        <aside>
            <div>
                <table style="width:100%;">
                    <tbody>
                        <th style="width:5%">
                            <form method="get" action="" class="form">
                                {% csrf_token %}
                                <select id="select_category" name="select_category">
                                    <option value="recently">최근순</option>
                                    <option value="views">조회순</option>
                                    <option value="likes">추천순</option>
                                </select>
                            </form>
                            <script>
                                $(document).ready(function() {
                                    $( "select[name=select_category]" ).val( "{{ my_category }}" );
                                    $('select[name=select_category]').change(function () {
                                    console.log($('select[name=select_category]').val());
                                    select_category = $('select[name=select_category]').val();
                                    $('.form').submit();
                                });
                            });
                            </script>
                        </th>
                        <th style="width:90%"></th>
                        <th style="width:5%">
                            <input type="button" onclick="location.href='/post/write/'" value="글쓰기"></input>
                        </th>
                    </tbody>
                </table>
                
                <table id="postsec">
                    <thead>
                        <re class="header">
                            <th style="width:6%">번호</th>
                            <th style="width:60%">제목</th>
                            <th style="width:10%">글쓴이</th>
                            <th style="width:10%">등록일</th>
                            <th style="width:7%">조회</th>
                            <th style="width:7%">추천</th>
                        </re>
                    </thead>
                    <tbody>
                        {% if count %}
                            {% if notice_post_list %}
                                {% for data in notice_post_list %}
                                <tr>
                                    <td style="text-align:center;">{{ data.num }}</td>
                                    <td>
                                        <a href="{% url 'post:detail' data.num %}" class="notice_post_title">
                                            {{ data.title}}
                                        </a>
                                    </td>
                                    <td style="text-align:center;">{{ data.nickname}}</td>
                                    <td style="text-align:center;">{{ data.time|date:'Y-m-d' }}</td>
                                    <td style="text-align:center;">{{ data.views }}</td>
                                    <td style="text-align:center;">{{ data.recommendation }}</td>
                                </tr>
                                {% endfor %}
                            {% endif %}
                            {% if post_list %}
                                {% for data in post_list %}
                                <tr>
                                    <td style="text-align:center;">{{ data.num }}</td>
                                    <td>
                                        <a href="{% url 'post:detail' data.num %}" class="post_title" >
                                            {{ data.title}}
                                        </a>
                                    </td>
                                    <td style="text-align:center;">{{ data.nickname}}</td>
                                    <td style="text-align:center;">{{ data.time|date:'Y-m-d' }}</td>
                                    <td style="text-align:center;">{{ data.views }}</td>
                                    <td style="text-align:center;">{{ data.recommendation }}</td>
                                </tr>
                                {% endfor %}
                            {% endif %}
                        {% else %}
                        <re class="header">
                            <tr>
                                <td></td>
                                <td style="text-align:center;">작성된 게시글이 없습니다.</td>
                            </tr>
                        </re>
                        {% endif %}
                    </tbody>
                </table>
                
                <table style="width:100%;">
                    <tbody>
                        <th style="width:95%">
                        </th>
                        <th style="width:5%">
                            <input type="button" onclick="location.href='/post/write/'" value="글쓰기"></input>
                        </th>
                    </tbody>
                </table>
                <table style="width:100%;">
                    <tbody>
                        <th>
                            
                            <form action="{% url 'post:index' %}" method="post">
                                {% csrf_token %}
                                <input type="text" name="search" id="search"value="{{search}}"></input>
                                <input type="submit" value="검색">
                            </form>
                        </th>
                    </tbody>
                </table>
                
            </div>

            <!-- Pagination -->
            <div style="text-align:center">
                <div class="pagination">
                    <div style="width:33%; margin: 5px;"></div>
                
                    <div style="width:10%; margin: 5px;">
                    {% if post_list.has_previous %}
                        <a class="abutton" href="?page=1">맨 앞으로</a>
                        <a class="abutton" href="?page={{ post_list.previous_page_number }}">이전</a>
                    {% endif %}
                    </div>

                    <div style="width:14%; margin: 5px;">
                    {% for page in post_list.paginator.page_range %}
                        {% if page >= post_list.number|add:-4 and page <= post_list.number|add:4 %}
                        <span class="{% if page == post_list.number %}current{% endif %}">
                            <a href="?page={{ page }}">{{ page}}</a>
                        </span>
                        {% elif page >= post_list.number|add:-5 and page <= post_list.number|add:5 %}
                            ..
                        {% endif %}
                    {% endfor %}
                    </div>

                    <div style="width:10%; margin: 5px;">
                    {% if post_list.has_next %}
                        <a class="abutton" href="?page={{ post_list.next_page_number }}">다음</a>
                        <a class="abutton" href="?page={{ post_list.paginator.num_pages }}">맨 뒤로</a>
                    {% endif %}
                    </div>

                    <div style="width:33%; margin: 5px;"></div>

                </div>  
            </div> 
        </aside>

        <section>

        </section>
    </main>

{% endblock %}


